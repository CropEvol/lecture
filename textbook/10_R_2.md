# R入門
編集中
## パッケージの利用
Rでは前回紹介した様に、三角関数や統計量を求める`sin`,`cos`,`mean`などの便利な関数が標準利用できます。<br>
しかし、より専門的な解析や、論文で発表されたばかりの統計手法などの場合は、もちろん標準では実装されていません。<br>
ただ、そういった場合でも、この様な手法はほとんど「パッケージ」としてまとめられ、公開されています。<br>
よって研究で最新の手法を追う場合や、より複雑な解析を行いたい場合には、パッケージをダウンロードし、Rから利用する形になります。<br>

### パッケージのインストール
パッケージは大抵[CRAN](https://cran.r-project.org)と呼ばれるところで公開されています。<br>
また、生物向けのパッケージは[Bioconductor](http://bioconductor.org)と呼ばれるところで公開されている場合もあります。<br>

#### CRANパッケージのインストール
CRANで公開されているパッケージをインストールするときは`install.packages("パッケージ名")`と打つことで行います。<br>
試しに次に使う予定のggplot2パッケージをインストールしてみて下さい。<br>
`install.packages("ggplot2", dependencies = TRUE)`<br>
dependencies=TRUEにすると、そのパッケージに必要な別のパッケージもまとめてインストールしてくれます。

#### Bioconductorパッケージのインストール
Bioconductorパッケージをインストールする場合は`biocLite`を利用します。<br>
試しに使う予定のBiostringsパッケージをインストールしてみて下さい。
```
source("http://bioconductor.org/biocLite.R")
biocLite("Biostrings")
```

### パッケージの呼び出し
パッケージをインストールした後、利用するには、以下の様にパッケージを呼び出す必要があります。<br>
`library(igraph)`
また、`library()`と打つことでインストールされているパッケージ一覧を表示したり、<br>
`search()`と打つことで、呼び出しているパッケージ一覧を表示することができます。<br>
パッケージの説明やパッケージに含まれている関数を調べたい場合は、`help(package="パッケージ名")`で調べることができます。<br><br>

`library`関数で呼び出したパッケージを消すには`detach(package:パッケージ名)`を利用する。
`detach(package:igraph)`<br><br>

それでは実際にパッケージを利用して行きます。

## グラフ描写
この章では、Rに標準実装されている機能やパッケージを利用してグラフ描写を行っていきます。
#### 標準実装されているplot
まずは、パッケージを使わないでグラフを描写する方法を試してみましょう。<br>
Rでもっとも基本的な描写関数は`plot(x軸のデータ, y軸のデータ, オプション)`です。
```
x <- 1:10
y <- c(2, 4, 6, 8, 10, 8, 6, 4, 6, 8)
plot(x, y)                       # 最も簡単な描写

plot(x, y, main="Title Name")    # オプションでタイトルを指定
```
オプションではタイトルやx軸、y軸の設定など様々な設定が行えます。<br>
また、数学関数を指定して、グラフを出力することもできます。<br>
`plot(関数名, 下限, 上限)`
```
plot(sin, -pi, 3*pi)             # sin関数を-π~3πまで描写
```
`persp(x軸データ, y軸データ, z軸データ)`で３次元プロットや、`hist()`と言う関数でヒストグラムを書くことも可能です。<br>
```
x <- 1:10
y <- 1:10
z <- matrix(rnorm(100), 10, 10)  # 正規分布から100個値を抽出し10*10の行列に
persp(x, y, z, theta = 30)       # 3次元グラフを描写

x <- rnorm(50)                   # 一次元データ
hist(x)                          # ヒストグラムを描写
```
このほかに`barplot()`や`boxplot()`、`mosaicplot()`などグラフ描写関数はまだまだたくさんあります。(前回の参考1を見てください。)<br>
しかし、いずれも最低限のグラフ描写のみで、使いこなせれば様々な種類の統計グラフを上手く描写できますが、<br>
綺麗なグラフにするためには、タイトルや色付け・グラフの重ね合わせなど、オプションとなる設定が煩わしいものになっています。<br>
そこで、グラフ描写用のパッケージを利用することで、手軽に綺麗なグラフを描写することが可能となります。
#### ggplot2の紹介
グラフ描写系のパッケージとして最もよく利用されていると思われるのが、この`ggplot2`です。


#### 使用例 : MAプロット
RNA-seqを行い得られた遺伝子発現量の可視化に利用されるグラフの一例としてMAプロットがあります。<br>
例）高温条件下で栽培した植物の遺伝子発現量と、対照区で栽培した植物の遺伝子発現量を比較する場合、など。<br>
発現量のデータとして、以下の様なデータを扱うことになります。

| 遺伝子 | 実験群での発現量 | 対照区での発現量 |
|:-----------:|:------------:|:------------:|
| ENSG00000133124 | 0.5517638 | -0.4480722|
| ENSG00000105396 | 0.70196253 | -0.04512949 |
| ENSG00000135144 | 0.5525213 | -0.4353797 |
| : | : | : |
| : | : | : |
| ENSG00000418308 | -0.05246954 | -0.70646699 |

MAプロットというのは、横軸を2グループの発現量の平均値:A値、縦軸を2グループ間の発現量の比:M値として表したもので、<br>
2グループ間における発現量の変動を見ることができます。
```
# http://~~には
# ２グループの発現量データからM, Aを算出したデータが入っている。
library(ggplot2)
x <- read.csv("rnaseq_data.csv", header=TRUE, sep=",")
g <- ggplot(x, aes(x = A, y = M, colour = Type))
g <- g + geom_point(alpha = 0.6)
g <- g + coord_fixed(ratio = 1)
print(g)
```
<img src="../images/10/maplot.png" height="200px" alt="unix directory"></div>
#### 参考資料

## 数値解析・統計モデルなど
#### データマイニング
データマイニングとは、膨大なデータ(鉱山)から意味のあるものを探し出すことを指します。<br>
大雑把に言うと、いわゆる古典的確率論や統計学はデータ全体の特徴を捉えるのに対し、全体の中から部分を探してくると言う形になります。<br>
生物学の世界でも、多数の実験要因や様々な条件下で集められたデータを解析する際に用いられる手法となります。<br>
特にゲノムデータの解析では、無数にある遺伝子の中から、意味のある遺伝子を選択したり効果を予測する等、密接に関わっている手法と言えます。<br>
あまり詳しく触れると数学的な要素が増えてしまうので簡単な紹介程度になりますが、〜〜〜などの手法が有名です。<br>
#### 主成分分析とかロジスティック回帰とかデータマイニング系/SVM?
## ネットワーク解析
#### 共発現解析
#### グラフ理論
#### igraphの紹介
#### (参考)CytoScapeの紹介
## 系統樹
#### 階層クラスタリング
#### apeの紹介
## Bioconductorからバイオインフォっぽいの
